!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.worldviewjs=t():n.worldviewjs=t()}(this,function(){return function(n){function t(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var e={};return t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}t.__esModule=!0;var o=e(7),a=r(o);t.default=a.default,n.exports=t.default},function(n,t){"use strict";t.__esModule=!0;var e=Math.PI;t.PI=e;var r=function(n){return Math.sin(n/180*e)};t.sin=r;var o=function(n){return Math.cos(n/180*e)};t.cos=o;var a=function(n,t){return(n+t)/2};t.avg=a;var u=function(n,t){return n-t};t.delta=u;var i=function(n,t){void 0===n&&(n=-(1/0));var e=arguments.length<=2||void 0===arguments[2]?1/0:arguments[2];return Math.min(e,Math.max(n,t))};t.bounded=i;var c={"+":function(n,t){return n+t},"-":function(n,t){return n-t},"*":function(n,t){return n*t},"/":function(n,t){return n/t},avg:a};t.ops=c},function(n,t,e){"use strict";t.__esModule=!0;var r=e(1),o=function(n){return function(t,e){return t.map(function(r,o){return n(t[o],e[o])})}},a=function(n,t){return t.map(function(t){return n*t})};t.scale=a;var u=o(r.ops["+"]);t.add=u;var i=o(r.ops["-"]);t.sub=i;var c=o(r.ops["*"]);t.dotProduct=c;var f=o(Math.min);t.min=f;var d=o(Math.max);t.max=d;var s=function(n,t,e){return f(d(n,t),e)};t.bounded=s;var l=function(n){return Math.sqrt(c(n,n).reduce(r.ops["+"]))};t.norm=l;var v=function(n){return a(1/l(n),n)};t.normalize=v;var p=Object.freeze([0,0]);t.zero=p,t.default={add:u,bounded:s,max:d,min:f,norm:l,normalize:v,scale:a,sub:i,zero:p}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}t.__esModule=!0;var o=e(2),a=r(o),u=e(4),i=function(n){return a.default.scale(.5,n.worldSize)};t.center_world=i;var c=function(n){return u.fromWorldToDocument(n,i(n))};t.centerWorld_document=c;var f=function(n){return u.fromWorldToContainer(n,i(n))};t.centerWorld_container=f;var d=function(n){return a.default.scale(.5,n.containerSize)};t.center_container=d;var s=function(n){return u.fromContainerToDocument(n,d(n))};t.centerContainer_document=s;var l=function(n){return u.fromContainerToWorld(n,d(n))};t.centerContainer_world=l},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}t.__esModule=!0;var o=e(2),a=r(o),u=e(6),i=r(u),c=function(n,t){var e=n.container_document;return a.default.sub(t,e)};t.fromDocumentToContainer=c;var f=function(n,t){var e=n.container_document;return a.default.add(t,e)};t.fromContainerToDocument=f;var d=function(n,t){var e=n.scale,r=n.theta,o=n.world_container;return a.default.add(a.default.scale(e,i.default.product(u.R(r),t)),o)};t.fromWorldToContainer=d;var s=function(n,t){var e=n.scale,r=n.theta,o=n.world_container;return a.default.scale(1/e,i.default.product(u.R(-r),a.default.sub(t,o)))};t.fromContainerToWorld=s;var l=function(n,t){var e=d(n,t);return f(n,e)};t.fromWorldToDocument=l;var v=function(n,t){var e=c(n,t);return s(n,e)};t.fromDocumentToWorld=v},function(n,t){"use strict";t.__esModule=!0;var e=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},r=function n(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){var r=e[0],o=e.slice(1);return r?n.apply(void 0,o)(r(t)):t}};t.flow=r;var o=function(n,t,r){var o;return e({},n,(o={},o[t]=r,o))};t.setState=o},function(n,t,e){"use strict";t.__esModule=!0;var r=e(1),o=function(n){return n instanceof Array&&"number"==typeof n[0]},a=function(n){return n instanceof Array&&n[0]instanceof Array&&"number"==typeof n[0][0]},u=function(n){return[[r.cos(n),-r.sin(n)],[r.sin(n),r.cos(n)]]};t.R=u;var i=function(n,t){return t.map(function(t){return t.map(function(t){return n*t})})};t.scale=i;var c=function(n,t){if(o(t))return[n[0][0]*t[0]+n[0][1]*t[1],n[1][0]*t[0]+n[1][1]*t[1]];if(a(t)){var e=function(){var e=[[void 0,void 0],[void 0,void 0]];return{v:e.map(function(r,o){return e.map(function(e,r){return n[o][0]*t[0][r]+n[o][1]*t[1][r]})})}}();if("object"==typeof e)return e.v}throw new Error("What are you trying to do?")};t.product=c;var f=function(n,t,e){return[[e(n[0][0],t[0][0]),e(n[0][1],t[0][1])],[e(n[1][0],t[1][0]),e(n[1][1],t[1][1])]]},d=function(n,t){return f(n,t,r.ops["-"])};t.sub=d;var s=function(n,t){return f(n,t,r.ops["+"])};t.add=s,t.default={R:u,add:s,product:c,scale:i,sub:d}},function(n,t,e){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}function o(n,t){function e(){return h.isZoomedOut()}function r(n,t,e,r){h.setWorldSize(n,t),h.setContainerSize(e,r),h.resetZoom(),_()}function o(n,t){h.resetContainerSize(n,t),_()}function a(n){var t=arguments.length<=1||void 0===arguments[1]?{pageX:void 0,pageY:void 0}:arguments[1],e=n>0?1.03:.97,r="number"==typeof t.pageX?d(t):void 0;h.zoomBy(e,r),_()}function i(n){var t=arguments.length<=1||void 0===arguments[1]?{pageX:void 0,pageY:void 0}:arguments[1],e="number"==typeof t.pageX?d(t):void 0;h.zoomBy(n,e),_()}function l(){var n=arguments.length<=0||void 0===arguments[0]?{pageX:void 0,pageY:void 0}:arguments[0];s("panStart",n),b.isPanning=!0,b.panStart=[n.pageX,n.pageY]}function v(){var n=arguments.length<=0||void 0===arguments[0]?{pageX:void 0,pageY:void 0}:arguments[0];b.isPanning&&(s("panMove",n),b.panEnd=[n.pageX,n.pageY],h.panBy(c.default.sub(b.panEnd,b.panStart)),b.panStart=b.panEnd,_())}function p(){var n=arguments.length<=0||void 0===arguments[0]?{pageX:void 0,pageY:void 0}:arguments[0];b.isPanning&&(s("panEnd",n),b.isPanning=!1,b.panEnd=[n.pageX,n.pageY])}function m(n,t){if(void 0===n||void 0===t)throw new Error("InvalidArguments: panBy(dx, dy) called with "+n+", "+t);h.panBy([n,t]),_()}function g(n){var t=n.translate,e=n.rotate,r=n.scale,o=function(n,t){var e=t[0],r=t[1];return"\n      translate("+-e+"px, "+-r+"px)\n      "+n+"\n      translate("+e+"px, "+r+"px)\n    "};return{translate:t,rotate:e,scale:r,transformTopLeft:"\n        translate("+t[0]+"px, "+t[1]+"px)\n        rotate("+e+")\n        scale("+r+")\n      ",transform5050:o("\n          translate("+t[0]+"px, "+t[1]+"px)\n          rotate("+e+")\n          scale("+r+")",f.center_world(h.state))}}function _(){var t=g(h.transform);return n(t),t}var h=new u.default(t),b={isPanning:!1,panStart:null,panEnd:null};return{setContainerOrigin:h.setContainerOrigin,isZoomedOut:e,zoomAtMouse:a,zoomBy:i,panBy:m,panStart:l,panMove:v,panEnd:p,setDimensions:r,resetContainerSize:o,publish:_,debug:{decorate:g,view:h}}}t.__esModule=!0,t.default=o;var a=e(9),u=r(a),i=e(2),c=r(i),f=e(3),d=function(n){var t=n.pageX,e=n.pageY;return[t,e]},s=function(n,t){if("number"!=typeof t.pageX||"number"!=typeof t.pageY)throw new Error("Trying to "+n+" without { pageX, pageY }. Check your event handler.")};n.exports=t.default},function(n,t,e){"use strict";function r(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}function o(n){return n&&n.__esModule?n:{default:n}}function a(n,t){var e=n.worldSize,r=n.containerSize,o=c(n),a=g.bounded(t.minZoom,Math.max(o,n.scale),t.maxZoom);return f({},n,{scale:a,world_container:s.default.bounded(s.default.sub(r,s.default.scale(a,e)),n.world_container,s.default.zero)})}function u(n,t){var e=n.worldSize,r=n.containerSize,o=c(n,Math.min),u=g.bounded(t.minZoom,Math.max(o,n.scale),t.maxZoom);if(u>=c(n,Math.max))return a(n,t);var d=s.default.scale(.5,s.default.sub(r,s.default.scale(u,e))),l=s.default.bounded(s.default.sub(r,s.default.scale(u,e)),n.world_container,s.default.zero),v={centered:d,fitted:l};return f({},n,{scale:u,world_container:i(n).map(function(n,t){return v[n][t]})})}function i(n){var t=n.worldSize,e=n.containerSize,r=e[0]/t[0],o=e[1]/t[1];return r<=o?["fitted","centered"]:["centered","fitted"]}function c(n){var t=n.worldSize,e=n.containerSize,r=arguments.length<=1||void 0===arguments[1]?Math.max:arguments[1],o=e[0]/t[0],a=e[1]/t[1];return r(o,a)}t.__esModule=!0;var f=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n};t.scaleLimit=c;var d=e(2),s=o(d),l=e(6),v=o(l),p=e(5),m=e(1),g=r(m),_=function(n,t){return function(e){return p.setState(e,n,t)}};t.set=_;var h=function(n){return n};t.identity=h;var b=function(n,t){return void 0===n&&(n=[]),[].concat(n).reduce(function(n,t){return t(n)},t)};t.reduce=b;var y=function(n,t){return function(e){var r=e.scale,o=e.world_container,a=s.default.add(t,s.default.scale(n/r,s.default.sub(o,t)));return f({},e,{world_container:a,scale:n})}};t.statelessZoom=y;var w=function(n){return function(t){var e=t.world_container,r=s.default.add(n,e);return f({},t,{world_container:r})}};t.statelessPanBy=w;var z=function(n){var t=arguments.length<=1||void 0===arguments[1]?[0,0]:arguments[1];return function(e){var r=e.theta,o=e.theta+n,a=e.world_container,u=s.default.sub(t,v.default.product(v.default.product(l.R(o),l.R(-r)),s.default.sub(t,a)));return f({},e,{theta:o,world_container:u})}};t.statelessRotateBy=z;var x=function(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(t){return n.fitNoWhitespace?a(t,n):u(t,n)}};t.fit=x},function(n,t,e){"use strict";function r(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}function o(n){function t(n){return d.bounded(M.minZoom,n,M.maxZoom)}function e(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];M=a({},M,n)}function r(n,t){var e=w(s.set("worldSize",[n,t]));x=s.reduce(e,x)}function o(n,t){var e=w(s.set("containerSize",[n,t]));x=s.reduce(e,x)}function f(n,t){x=i.setState(x,"container_document",[n,t])}function l(n,t){var e=w(s.set("world_container",[n,t]));x=s.reduce(e,x)}function v(n){x=i.setState(x,"theta",n)}function p(n){var e=w(s.set("scale",t(n)));x=s.reduce(e,x)}function m(n,t){var e=n/x.containerSize[0],r=[s.statelessZoom(e*x.scale,[0,0]),s.set("containerSize",[n,t])];x=s.reduce(r,x)}function g(){x=M.fit?s.reduce([s.set("scale",-1),s.fit(M)],x):s.reduce(s.set("scale",t(1)),x)}function _(n,e){if(void 0===n&&(n=1),n<=0)throw new Error("zoomBy:: Change must be a positive ratio.");var r=t(x.scale*n);h(r,e)}function h(n,e){var r=e instanceof Array?c.fromDocumentToContainer(x,e):u.center_container(x),o=w(s.statelessZoom(t(n),r));x=s.reduce(o,x)}function b(n){var t=w(s.statelessPanBy(n));x=s.reduce(t,x)}function y(n,t){var e=t instanceof Array?c.fromDocumentToContainer(x,t):u.center_container(x),r=s.statelessRotateBy(n,e);x=r(x)}function w(n){return[].concat(n,M.fit?s.fit(M):s.identity)}function z(){var n=s.scaleLimit(x);return x.scale===M.minZoom||x.scale===n}var x={scale:1,theta:0,container_document:[0,0],world_container:[0,0],worldSize:[1,1],containerSize:[1,1]},M=a({fit:!1,fitNoWhitespace:!0,maxZoom:void 0,minZoom:void 0},n);return Object.defineProperties({panBy:b,resetContainerSize:m,resetZoom:g,rotateBy:y,setContainerOrigin:f,setContainerSize:o,setOptions:e,setTheta:v,setWorldOrigin:l,setWorldSize:r,setZoom:p,zoomBy:_,zoomTo:h,isZoomedOut:z},{options:{get:function(){return M},configurable:!0,enumerable:!0},state:{get:function(){return x},configurable:!0,enumerable:!0},transform:{get:function(){return{translate:x.world_container,rotate:x.theta,scale:x.scale}},configurable:!0,enumerable:!0}})}t.__esModule=!0;var a=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n};t.default=o;var u=e(3),i=e(5),c=e(4),f=e(1),d=r(f),s=e(8);n.exports=t.default}])});