!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.worldviewjs=e():n.worldviewjs=e()}(this,function(){return function(n){function e(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=n,e.c=t,e.p="",e(0)}([function(n,e,t){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}e.__esModule=!0;var o=t(7),a=r(o);e.default=a.default,n.exports=e.default},function(n,e){"use strict";e.__esModule=!0;var t=Math.PI;e.PI=t;var r=function(n){return Math.sin(n/180*t)};e.sin=r;var o=function(n){return Math.cos(n/180*t)};e.cos=o;var a=function(n,e){return(n+e)/2};e.avg=a;var u=function(n,e){return n-e};e.delta=u;var i=function(n,e){void 0===n&&(n=-(1/0));var t=arguments.length<=2||void 0===arguments[2]?1/0:arguments[2];return Math.min(t,Math.max(n,e))};e.bounded=i;var c=function(n,e,t){return n<=e&&e<=t};e.isBounded=c;var f={"+":function(n,e){return n+e},"-":function(n,e){return n-e},"*":function(n,e){return n*e},"/":function(n,e){return n/e},avg:a};e.ops=f},function(n,e,t){"use strict";e.__esModule=!0;var r=t(1),o=function(n){return function(e,t){return e.map(function(r,o){return n(e[o],t[o])})}},a=function(n,e){return e.map(function(e){return n*e})};e.scale=a;var u=o(r.ops["+"]);e.add=u;var i=o(r.ops["-"]);e.sub=i;var c=o(r.ops["*"]);e.dotProduct=c;var f=o(Math.min);e.min=f;var s=o(Math.max);e.max=s;var d=function(n,e,t){return f(s(n,e),t)};e.bounded=d;var l=function(n){return Math.sqrt(c(n,n).reduce(r.ops["+"]))};e.norm=l;var v=function(n){return a(1/l(n),n)};e.normalize=v;var p=Object.freeze([0,0]);e.zero=p;var m=function(n){return n.map(Math.abs)};e.abs=m,e.default={abs:m,add:u,bounded:d,max:s,min:f,norm:l,normalize:v,scale:a,sub:i,zero:p}},function(n,e,t){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}e.__esModule=!0;var o=t(2),a=r(o),u=t(4),i=function(n){return a.default.scale(.5,n.worldSize)};e.center_world=i;var c=function(n){return u.fromWorldToDocument(n,i(n))};e.centerWorld_document=c;var f=function(n){return u.fromWorldToContainer(n,i(n))};e.centerWorld_container=f;var s=function(n){return a.default.scale(.5,n.containerSize)};e.center_container=s;var d=function(n){return u.fromContainerToDocument(n,s(n))};e.centerContainer_document=d;var l=function(n){return u.fromContainerToWorld(n,s(n))};e.centerContainer_world=l},function(n,e,t){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}e.__esModule=!0;var o=t(2),a=r(o),u=t(6),i=r(u),c=function(n,e){var t=n.container_document;return a.default.sub(e,t)};e.fromDocumentToContainer=c;var f=function(n,e){var t=n.container_document;return a.default.add(e,t)};e.fromContainerToDocument=f;var s=function(n,e){var t=n.scale,r=n.theta,o=n.world_container;return a.default.add(a.default.scale(t,i.default.product(u.R(r),e)),o)};e.fromWorldToContainer=s;var d=function(n,e){var t=n.scale,r=n.theta,o=n.world_container;return a.default.scale(1/t,i.default.product(u.R(-r),a.default.sub(e,o)))};e.fromContainerToWorld=d;var l=function(n,e){var t=s(n,e);return f(n,t)};e.fromWorldToDocument=l;var v=function(n,e){var t=c(n,e);return d(n,t)};e.fromDocumentToWorld=v},function(n,e){"use strict";e.__esModule=!0;var t=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},r=function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r=t[0],o=t.slice(1);return r?n.apply(void 0,o)(r(e)):e}};e.flow=r;var o=function(n,e,r){var o;return t({},n,(o={},o[e]=r,o))};e.setState=o},function(n,e,t){"use strict";e.__esModule=!0;var r=t(1),o=function(n){return n instanceof Array&&"number"==typeof n[0]},a=function(n){return n instanceof Array&&n[0]instanceof Array&&"number"==typeof n[0][0]},u=function(n){return[[r.cos(n),-r.sin(n)],[r.sin(n),r.cos(n)]]};e.R=u;var i=function(n,e){return e.map(function(e){return e.map(function(e){return n*e})})};e.scale=i;var c=function(n,e){if(o(e))return[n[0][0]*e[0]+n[0][1]*e[1],n[1][0]*e[0]+n[1][1]*e[1]];if(a(e)){var t=function(){var t=[[void 0,void 0],[void 0,void 0]];return{v:t.map(function(r,o){return t.map(function(t,r){return n[o][0]*e[0][r]+n[o][1]*e[1][r]})})}}();if("object"==typeof t)return t.v}throw new Error("What are you trying to do?")};e.product=c;var f=function(n,e,t){return[[t(n[0][0],e[0][0]),t(n[0][1],e[0][1])],[t(n[1][0],e[1][0]),t(n[1][1],e[1][1])]]},s=function(n,e){return f(n,e,r.ops["-"])};e.sub=s;var d=function(n,e){return f(n,e,r.ops["+"])};e.add=d,e.default={R:u,add:d,product:c,scale:i,sub:s}},function(n,e,t){"use strict";function r(n){return n&&n.__esModule?n:{default:n}}function o(n,e){function t(){var n=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return h.isZoomedOut(n)}function r(n,e,t,r){h.setWorldSize(n,e),h.setContainerSize(t,r),h.resetZoom(),b()}function o(n,e){h.resetContainerSize(n,e),b()}function a(n){var e=arguments.length<=1||void 0===arguments[1]?{pageX:void 0,pageY:void 0}:arguments[1],t=n>0?1.03:.97,r="number"==typeof e.pageX?s(e):void 0;h.zoomBy(t,r),b()}function i(n){var e=arguments.length<=1||void 0===arguments[1]?{pageX:void 0,pageY:void 0}:arguments[1],t="number"==typeof e.pageX?s(e):void 0;h.zoomBy(n,t),b()}function l(){var n=arguments.length<=0||void 0===arguments[0]?{pageX:void 0,pageY:void 0}:arguments[0];d("panStart",n),_.isPanning=!0,_.panStart=[n.pageX,n.pageY]}function v(){var n=arguments.length<=0||void 0===arguments[0]?{pageX:void 0,pageY:void 0}:arguments[0];_.isPanning&&(d("panMove",n),_.panEnd=[n.pageX,n.pageY],h.panBy(c.default.sub(_.panEnd,_.panStart)),_.panStart=_.panEnd,b())}function p(){var n=arguments.length<=0||void 0===arguments[0]?{pageX:void 0,pageY:void 0}:arguments[0];_.isPanning&&(d("panEnd",n),_.isPanning=!1,_.panEnd=[n.pageX,n.pageY])}function m(n,e){if(void 0===n||void 0===e)throw new Error("InvalidArguments: panBy(dx, dy) called with "+n+", "+e);h.panBy([n,e]),b()}function g(n){var e=n.translate,t=n.rotate,r=n.scale,o=function(n,e){var t=e[0],r=e[1];return"\n      translate("+-t+"px, "+-r+"px)\n      "+n+"\n      translate("+t+"px, "+r+"px)\n    "};return{translate:e,rotate:t,scale:r,transformTopLeft:"\n        translate("+e[0]+"px, "+e[1]+"px)\n        rotate("+t+")\n        scale("+r+")\n      ",transform5050:o("\n          translate("+e[0]+"px, "+e[1]+"px)\n          rotate("+t+")\n          scale("+r+")",f.center_world(h.state))}}function b(){var e=g(h.transform);return n(e),e}var h=new u.default(e),_={isPanning:!1,panStart:null,panEnd:null};return Object.defineProperties({isZoomedOut:t,setDimensions:r,setOptions:h.setOptions,setContainerOrigin:h.setContainerOrigin,zoomAtMouse:a,zoomBy:i,panBy:m,panStart:l,panMove:v,panEnd:p,resetContainerSize:o,publish:b,debug:{decorate:g,view:h}},{state:{get:function(){return h.state},configurable:!0,enumerable:!0},transform:{get:function(){return h.transform},configurable:!0,enumerable:!0},options:{get:function(){return h.options},configurable:!0,enumerable:!0},scale:{get:function(){return h.state.scale},configurable:!0,enumerable:!0},translate:{get:function(){return h.state.world_container},configurable:!0,enumerable:!0},offset:{get:function(){return h.state.container_document},configurable:!0,enumerable:!0},rotation:{get:function(){return h.state.theta},configurable:!0,enumerable:!0},worldSize:{get:function(){return h.state.worldSize},configurable:!0,enumerable:!0},containerSize:{get:function(){return h.state.containerSize},configurable:!0,enumerable:!0},theta:{get:function(){return h.state.theta},configurable:!0,enumerable:!0}})}e.__esModule=!0,e.default=o;var a=t(9),u=r(a),i=t(2),c=r(i),f=t(3),s=function(n){var e=n.pageX,t=n.pageY;return[e,t]},d=function(n,e){if("number"!=typeof e.pageX||"number"!=typeof e.pageY)throw new Error("Trying to "+n+" without { pageX, pageY }. Check your event handler.")};n.exports=e.default},function(n,e,t){"use strict";function r(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function o(n){return n&&n.__esModule?n:{default:n}}function a(n,e){var t=n.worldSize,r=n.containerSize,o=i(n,e),a=m.bounded(e.minZoom,Math.max(o,n.scale),e.maxZoom);return c({},n,{scale:a,world_container:s.default.bounded(s.default.sub(r,s.default.scale(a,t)),n.world_container,s.default.zero)})}function u(n,e){var t=n.worldSize,r=n.containerSize,o=i(n,e,Math.min),a=s.default.scale(.5,s.default.sub(s.default.scale(1/o,r),t)),u=m.bounded(e.minZoom,Math.max(o,n.scale),e.maxZoom),f=s.default.bounded(s.default.sub(r,s.default.scale(u,s.default.add(t,a))),n.world_container,s.default.scale(u,a));return c({},n,{scale:u,world_container:f})}function i(n){var e=n.worldSize,t=n.containerSize,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.fitMarginX,a=void 0===o?0:o,u=r.fitMarginY,i=void 0===u?0:u,c=arguments.length<=2||void 0===arguments[2]?Math.max:arguments[2],f=(t[0]-2*a)/e[0],s=(t[1]-2*i)/e[1];return c(f,s)}e.__esModule=!0;var c=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n};e.scaleLimit=i;var f=t(2),s=o(f),d=t(6),l=o(d),v=t(5),p=t(1),m=r(p),g=function(n,e){return function(t){return v.setState(t,n,e)}};e.set=g;var b=function(n){return n};e.identity=b;var h=function(n,e){return void 0===n&&(n=[]),[].concat(n).reduce(function(n,e){return e(n)},e)};e.reduce=h;var _=function(n,e){return function(t){var r=t.scale,o=t.world_container,a=s.default.add(e,s.default.scale(n/r,s.default.sub(o,e)));return c({},t,{world_container:a,scale:n})}};e.statelessZoom=_;var y=function(n){return function(e){var t=e.world_container,r=s.default.add(n,t);return c({},e,{world_container:r})}};e.statelessPanBy=y;var w=function(n){var e=arguments.length<=1||void 0===arguments[1]?[0,0]:arguments[1];return function(t){var r=t.theta,o=t.theta+n,a=t.world_container,u=s.default.sub(e,l.default.product(l.default.product(d.R(o),d.R(-r)),s.default.sub(e,a)));return c({},t,{theta:o,world_container:u})}};e.statelessRotateBy=w;var M=function(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(e){return n.fitNoWhitespace?a(e,n):u(e,n)}};e.fit=M},function(n,e,t){"use strict";function r(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function o(n){function e(n){return s.bounded(S.minZoom,n,S.maxZoom)}function t(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];S=a({},S,n)}function r(n,e){var t=w(d.set("worldSize",[n,e]));z=d.reduce(t,z)}function o(n,e){var t=w(d.set("containerSize",[n,e]));z=d.reduce(t,z)}function f(n,e){z=i.setState(z,"container_document",[n,e])}function l(n,e){var t=w(d.set("world_container",[n,e]));z=d.reduce(t,z)}function v(n){z=i.setState(z,"theta",n)}function p(n){var t=w(d.set("scale",e(n)));z=d.reduce(t,z)}function m(n,e){var t=n/z.containerSize[0],r=[d.statelessZoom(t*z.scale,[0,0]),d.set("containerSize",[n,e])];z=d.reduce(r,z)}function g(){z=S.fit?d.reduce([d.set("scale",-1),d.fit(S)],z):d.reduce(d.set("scale",e(1)),z)}function b(n,t){if(void 0===n&&(n=1),n<=0)throw new Error("zoomBy:: Change must be a positive ratio.");var r=e(z.scale*n);h(r,t)}function h(n,t){var r=t instanceof Array?c.fromDocumentToContainer(z,t):u.center_container(z),o=w(d.statelessZoom(e(n),r));z=d.reduce(o,z)}function _(n){var e=w(d.statelessPanBy(n));z=d.reduce(e,z)}function y(n,e){var t=e instanceof Array?c.fromDocumentToContainer(z,e):u.center_container(z),r=d.statelessRotateBy(n,t);z=r(z)}function w(n){return[].concat(n,S.fit?d.fit(S):d.identity)}function M(){var n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=d.scaleLimit(z,S,S.fitNoWhitespace?Math.max:Math.min),t=z.scale<=S.minZoom+n,r=z.scale<=e+n;return S.fit&&S.minZoom?t||r:S.fit?r:!!S.minZoom&&t}var z={scale:1,theta:0,container_document:[0,0],world_container:[0,0],worldSize:[1,1],containerSize:[1,1]},S=a({fit:!1,fitNoWhitespace:!0,fitMarginX:0,firMarginY:0,maxZoom:void 0,minZoom:void 0},n);return Object.defineProperties({panBy:_,resetContainerSize:m,resetZoom:g,rotateBy:y,setContainerOrigin:f,setContainerSize:o,setOptions:t,setTheta:v,setWorldOrigin:l,setWorldSize:r,setZoom:p,zoomBy:b,zoomTo:h,isZoomedOut:M},{options:{get:function(){return S},configurable:!0,enumerable:!0},state:{get:function(){return z},configurable:!0,enumerable:!0},transform:{get:function(){return{translate:z.world_container,rotate:z.theta,scale:z.scale}},configurable:!0,enumerable:!0}})}e.__esModule=!0;var a=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n};e.default=o;var u=t(3),i=t(5),c=t(4),f=t(1),s=r(f),d=t(8);n.exports=e.default}])});